(function(n){n.bt||(n.bt={});var t="bt-draw";n.bt.draw=function(t,i){var u=n.extend({},{controls:".js-bt-controls"},i),f=this,h=n(t),r,e,o=function(){console.log("drawNet",r)},s=function(){return e=n(u.controls),f};return this.setConfig=function(n){r=n;o()},s.call(this)};n.fn.btDraw=function(i,r){var u,f;return typeof i=="string"?(f=null,this.each(function(){return u=n.data(this,t),u&&typeof u[i]=="function"&&(f=u[i].call(u,r)),f}),f):this.each(function(){return u=new n.bt.draw(this,i),n.data(this,t,u),u})}})(jQuery),function(n){n.bt||(n.bt={});var t="bt-controls";n.bt.controls=function(t,i){var c=n.extend({},{draw:".js-bt-draw",url:""},i),l=this,f=n(t),r,e,u,o,s,a=function(n){if(console.log("sendRequest:",n),r.readyState===WebSocket.OPEN){var t=JSON.stringify(n);r.send(t)}else u.text("Connection is closed")},h=function(n,t){o.append('<div class="alert alert-danger">'+(t?"<b>"+t+":<\/b> ":"")+n+"<\/div>")},v=function(){a({Action:"getnetconfig"})},y=function(){u=n('<div class="bt-controls-status"><\/div>').appendTo(f);o=n('<div class="bt-controls-text"><\/div>').appendTo(f)},p=function(){var t,i;return y(),s=n(c.draw),t=f.data("url"),t||(i=window.location.host,t="ws://"+i+"/brain-torus"),r=new WebSocket(t),r.onopen=function(){u.text("connected");v()},r.onmessage=function(n){var t=JSON.parse(n.data);if(typeof t.Error!="undefined"&&t.Error)h(t.Error,t.Action);else switch(t.Action){case"getnetconfig":e=t;s.btDraw("setConfig",e)}},r.onerror=function(n){console.log(n);h(n.message)},r.onclose=function(){console.log(arguments);var t=arguments,n="";typeof arguments!==undefined&&arguments.length>0&&typeof arguments[0].reason!="undefined"&&(n=" reason: "+arguments[0].reason);u.text("disconnected."+n)},l};return p.call(this)};n.fn.btControls=function(i,r){var u,f;return typeof i=="string"?(f=null,this.each(function(){return u=n.data(this,t),u&&typeof u[i]=="function"&&(f=u[i].call(u,r)),f}),f):this.each(function(){return u=new n.bt.controls(this,i),n.data(this,t,u),u})}}(jQuery);$().ready(function(){$(".js-bt-draw").btDraw();$(".js-bt-controls").btControls()});