(function(n){n.bt||(n.bt={});var t="bt-controls";n.bt.controls=function(t,i){var y=n.extend({},{url:"",id:""},i),s=this,f=n(t),r,h,u,e,c=function(n){if(console.log("sendRequest:",n),r.readyState===WebSocket.OPEN){var t=JSON.stringify(n);r.send(t)}else u.text("Connection is closed")},o=function(n,t){e.append('<div class="alert alert-danger">'+(t?"<b>"+t+":<\/b> ":"")+n+"<\/div>")},l=function(){c({Action:"getnetconfig"})},a=function(){u=n('<div class="bt-controls-status"><\/div>').appendTo(f);e=n('<div class="bt-controls-text"><\/div>').appendTo(f)},v=function(){var n,t;return a(),n=f.data("url"),n||(t=window.location.host,n="ws://"+t+"/brain-torus"),r=new WebSocket(n),r.onopen=function(){u.text("connected");l()},r.onmessage=function(n){var t=JSON.parse(n.data);if(console.log("onmessage:",n.data,t),typeof t.Error!="undefined"&&t.Error)o(t.Error,t.Action);else switch(t.Action){case"getnetconfig":h=t}},r.onerror=function(n){console.log(n);o(n.message)},r.onclose=function(){console.log(arguments);var t=arguments,n="";typeof arguments!==undefined&&arguments.length>0&&typeof arguments[0].reason!="undefined"&&(n=" reason: "+arguments[0].reason);u.text("disconnected."+n)},s};return v.call(this)};n.fn.btControls=function(i,r){var u,f;return typeof i=="string"?(f=null,this.each(function(){return u=n.data(this,t),u&&typeof u[i]=="function"&&(f=u[i].call(u,r)),f}),f):this.each(function(){return u=new n.bt.controls(this,i),n.data(this,t,u),u})}})(jQuery);$().ready(function(){$(".js-bt-controls").btControls()});